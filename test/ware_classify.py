import pandas as pd
import os
import shutil

def get_ware_label(df, file_name):
    return df.loc[df['filename'] == file_name, 'label']

def classify_and_move(input_folder, csv_path, malware_folder, benignware_folder):
    df = pd.read_csv(csv_path)
    for file_name in os.listdir(input_folder_path):
        file_path = os.path.join(input_folder, file_name)
        if (get_ware_label(df, file_name) == 'malware').any():
            target_folder = malware_folder
        else:
            target_folder = benignware_folder
        print("Copy {} to {}.".format(file_name, target_folder))
        shutil.copy(file_path, os.path.join(target_folder, file_name))

if __name__ == "__main__":
    input_folder_path = "dataset/data"
    csv_file_path = "dataset/dataset.csv"
    malware_folder_path = "Dataset/malware"
    benignware_folder_path = "Dataset/benignware"

    classify_and_move(input_folder_path, csv_file_path, malware_folder_path, benignware_folder_path)
