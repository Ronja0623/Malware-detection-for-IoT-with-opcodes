import os
import pandas as pd
from multiprocessing import Pool, cpu_count

input_dir = './Disassemble'
file_list = os.listdir(input_dir)

def drop_addr(file_name):
    path = os.path.join(input_dir, file_name)
    df = pd.read_csv(path)
    if 'addr' in df.columns:
        df = df['opcode']
        df.to_csv(path)

if __name__ == '__main__':
    with Pool(cpu_count()) as pool:
        pool.map(drop_addr, file_list)