import os
import pandas as pd
from datetime import datetime

def set_dataset_description(df):
    global df_dataset_description
    df_dataset_description = df

def get_ware_label(file_name):
    return df_dataset_description.loc[df_dataset_description['filename'] == file_name, 'label'].values[0].split()[-1]

def get_ware_CPU_Arc(file_name):
    return df_dataset_description.loc[df_dataset_description['filename'] == file_name, 'CPU Architecture'].values[0].split()[-1]

# get MIPS_list: get_filtered_list('CPU Architecture', 'MIPS')
def get_filtered_list(column_name, key_str):
    return df_dataset_description[df_dataset_description[column_name].str.contains(key_str)]['filename'].tolist()

def set_ware_num():
        value_counts = df_dataset_description['label'].value_counts()
        return value_counts.get('benignware', 0), value_counts.get('malware', 0)

def get_filename_with_time(str, extension):
    now = datetime.now()
    time_str = now.strftime('_%m-%d-%H-%M-%S')
    file_name = str + time_str + extension
    return file_name

if __name__ == '__main__':
    # print(get_filename_with_time('a', '.txt'))
    set_dataset_description(pd.read_csv(os.path.join('Dataset','dataset.csv')))
    print(get_ware_label('6200704ebd2589bd844d97de0c827e9109c2c148a3d880bf241b50906354ec24'))