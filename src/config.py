import os
import pandas as pd
from malwareDetector.config import read_config

class subDetectorConfig():
    def __init__(self):
        self.tmp = inheritedConfig()
        self.baseConfig = self.tmp.config
        self.subConfig = nonInheritedConfig(self.baseConfig.folder.dataset)

class inheritedConfig():
    def __init__(self):
        self.config = read_config()
        self.config.folder.set_folder("disassemble", "Disassemble")

class nonInheritedConfig():
    def __init__(self, input_dir_path): # dataset
        self.WARETYPE = ['benignware', 'malware']
        self.CPU_ARC = ['ARM', 'MIPS', 'PowerPC']
        self.file_list = os.listdir(os.path.join(input_dir_path, 'data'))
        self.df_dataset_description = pd.read_csv(os.path.join(input_dir_path, 'dataset.csv'))
        self.set_ware_num()
        self.FEATURE_SELECTION_RATE = 0.0001

    def set_ware_num(self):
        value_counts = self.df_dataset_description['label'].value_counts()
        self.NUM_BENIGNWARE = value_counts.get('benignware', 0)
        self.NUM_MALWARE = value_counts.get('malware', 0)