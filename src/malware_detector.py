import os
import pandas as pd
from config import subDetectorConfig
from multiprocessing import Pool, cpu_count
from malwareDetector.detector import detector
from preprocess import disassemble_helper
from extract_feature import extractFeature
# from vectorization import vectorization_helper

class subDetector(detector):
    def __init__(self) -> None:
        self.config = subDetectorConfig()
        ## Multiprocess
        self.POOL = Pool(cpu_count())

    def preprocess(self):
        self.POOL.map(disassemble_helper, self.config.subConfig.file_list)
    
    def extractFeature(self):
        ff = extractFeature()
        ff.func_helper()
    '''
    def vectorize(self) -> np.array:
        self.POOL.map(vectorization_helper, self.config.subConfig.file_list)

    def model(self) -> Any:
        return 'This is the implementation of the model function from the derived class.'

    def predict(self) -> np.array:
        return 'This is the implementation of the predict function from the derived class.'
    '''
    
    def mkdir(self):
        for folder in self.config.baseConfig.folder.folder_list:
            os.makedirs(folder, exist_ok=True)

if __name__ == '__main__':
    myDetector = subDetector()
    myDetector.mkdir()
    myDetector.preprocess()
    # myDetector.extractFeature()