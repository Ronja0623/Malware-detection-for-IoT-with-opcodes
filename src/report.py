import os
import pandas as pd
from config import subDetectorConfig

class Report:
    def __init__(self):
        self.config = subDetectorConfig()

    # NOTE: repeat code!
    def get_ngrams_file_path(self, wt, ca, idx):
        return os.path.join(self.config.baseConfig.folder.feature, f"{idx}-grams_{wt}_{ca}.csv")

    def get_gram_num(self):
        for ca in self.config.subConfig.CPU_ARC:
            print(ca)
            print('malware')
            print(f'unigram: {pd.read_csv(self.get_ngrams_file_path("malware", ca, 1)).shape[0]}')
            print(f'bigram: {pd.read_csv(self.get_ngrams_file_path("malware", ca, 2)).shape[0]}')
            print('benignware')
            print(f'unigram: {pd.read_csv(self.get_ngrams_file_path("benignware", ca, 1)).shape[0]}')
            print(f'bigram: {pd.read_csv(self.get_ngrams_file_path("benignware", ca, 2)).shape[0]}')

if __name__ == "__main__":
    report = Report()
    report.get_gram_num()
